<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> MFM Speedup | Fang Tian </title> <meta name="author" content="Fang Tian"> <meta name="description" content="Use machine learning to accelerate a computational model (MFM) of human brains"> <meta name="keywords" content="NUS, National University of Singapore, AI, ML"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png?0bdd62eb7845399603fed636c3dc64bd"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://t-fang.github.io/projects/mfm_speedup/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold"> Fang Tian </span> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Papers </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">MFM Speedup</h1> <p class="post-description">Use machine learning to accelerate a computational model (MFM) of human brains</p> </header> <article> <p>This was a research internship project at <a href="https://scholar.google.com/citations?user=BOUzsU8AAAAJ" rel="external nofollow noopener" target="_blank">Prof. B.T. Thomas Yeo</a>’s <a href="https://sites.google.com/view/yeolab" rel="external nofollow noopener" target="_blank">lab</a> at the <a href="https://nus.edu.sg/" rel="external nofollow noopener" target="_blank">National University of Singapore</a>. The goal of this project is to leverage machine learning and deep learning to accelerate the parameter optimization process for the mean-field model(MFM), or more precisely parametric MFM (pMFM).</p> <p>The <a href="https://www.nature.com/articles/s41467-021-26704-y" rel="external nofollow noopener" target="_blank">pMFM</a> is a computational model of human brains that simulates brain activities through an ordinary differential equation (ODE) system to produce realistic functional MRI (fMRI) signals. The model is used to study the dynamics of brain activity and to understand how different brain regions communicate with each other.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/pMFM_speedup/pMFM_Fig1A-480.webp 480w,/assets/img/projects/pMFM_speedup/pMFM_Fig1A-800.webp 800w,/assets/img/projects/pMFM_speedup/pMFM_Fig1A-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/pMFM_speedup/pMFM_Fig1A.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Illustration of the pMFM" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Illustration of the pMFM, for more details, please refer to the original <a href="https://www.nature.com/articles/s41467-021-26704-y" rel="external nofollow noopener" target="_blank">paper</a> </div> <p>The original pMFM’s parameter optimization process utilizes Euler integration to numerically solve the ODE system, which can be computationally expensive to run. Therefore, I aim to speed up the parameter optimization process by using machine learning techniques to predict the MFM parameters’ performances without the need to solve ODEs. Specifically, I performed the following tasks:</p> <ol> <li>Generated a synthetic dataset of pMFM parameters and their corresponding performance.</li> <li>Validated two assumptions.</li> <li>Explored different machine learning models to predict the pMFM parameters’ performances.</li> <li>Explored various optimization techniques such as Covariance matrix adaptation evolution strategy (CMA-ES) and Gradient Descent.</li> </ol> <p>In the end, I have demonstrated the feasibility of using machine learning to accelerate the pMFM parameter optimization process, achieving a speedup of <strong>5,000x</strong> compared to the original Euler integration method. This project has led to a paper <a class="citation" href="#Zeng2024DELSSOME">(Zeng* et al., 2024)</a> that we are currently preparing for submission to <em>Nature Methods</em>. For more details of this project, please visit the <a href="https://github.com/T-Fang/pMFM_speedup/tree/main?tab=readme-ov-file" rel="external nofollow noopener" target="_blank">GitHub repository</a>.</p> </article> <h2>References</h2> <div class="publications"> <h2 class="bibliography">2024</h2> <ol class="bibliography"><li> <div class="row"> <div class="col col-sm-2 abbr"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/publication_preview/DELSSOME_preview-480.webp 480w,/assets/img/publication_preview/DELSSOME_preview-800.webp 800w,/assets/img/publication_preview/DELSSOME_preview-1400.webp 1400w," type="image/webp" sizes="200px"> <img src="/assets/img/publication_preview/DELSSOME_preview.png" class="preview z-depth-1 rounded" width="100%" height="auto" alt="DELSSOME_preview.png" data-zoomable loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </source></picture> </figure> </div> <div id="Zeng2024DELSSOME" class="col-sm-8"> <div class="title">Optimizing Biophysically-Plausible Large-Scale Circuit Models With Deep Neural Networks</div> <div class="author"> <a href="https://www.linkedin.com/in/tianchu-zeng-31a16926a/" rel="external nofollow noopener" target="_blank">Tianchu Zeng<sup>*</sup></a>, <em> <span class="font-weight-bold">Fang Tian<sup>*</sup></span> </em>, <a href="https://scholar.google.com/citations?user=UjadXKMAAAAJ" rel="external nofollow noopener" target="_blank">Shaoshi Zhang</a>, <a href="https://scholar.google.com/citations?user=xMh3uN8AAAAJ" rel="external nofollow noopener" target="_blank">Gustavo Deco</a>, <a href="https://scholar.google.com/citations?user=E9pynwoAAAAJ" rel="external nofollow noopener" target="_blank">Theodore D. Satterthwaite</a>, <a href="https://scholar.google.com/citations?user=EhyhJkwAAAAJ" rel="external nofollow noopener" target="_blank">Avram Holmes</a>, and <a href="https://scholar.google.com/citations?user=BOUzsU8AAAAJ" rel="external nofollow noopener" target="_blank">B.T. Thomas Yeo</a> <i class="fa-solid fa-circle-info ml-1" data-toggle="popover" data-placement="top" data-html="true" data-content="* equal contribution"> </i> </div> <div class="periodical"> <em></em> 2024 </div> <div class="periodical"> </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="/assets/pdf/DELSSOME.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="abstract hidden"> <p>Biophysically plausible large-circuit models provide valuable mechanistic insights into neural dynamics. However, setting up a model involves numerous free parameters, which are often manually set, leading to assumptions that may not align with biological plausibility. In contrast, optimizing these parameters results in more biologically plausible models. Previous papers have shown that spatially heterogeneous parameters improve the model performance in generating realistic neural dynamics. Prior works have employed iterative forward simulations via Euler integration to optimize the parameters, which require solving ordinary differential equations (ODE) for all regions simultaneously and each time step sequentially. This process poses a computational hurdle for an efficient model inversion. To tackle this problem, we propose DELSSOME (Deep Learning for Surrogate Statistics Optimization in Mean Field Modeling), which integrates deep learning models into neural mass model framework to circumvent the need to solve ODEs. These deep learning models are designed to learn surrogate statistics, which directly provide outputs required for optimization, from the input local circuit parameters. Our experiments demonstrate that our approach leads to a remarkable 500,000% speed-up of parameter optimization process compared to the traditional approach while achieving comparable performances. Moreover, our approach successfully replicates previous findings on excitation-inhibition ratio changes related to neurodevelopment and cognition. Overall, our results suggest the efficiency and broader applicability of the proposed approach in uncovering intricate neural dynamics.</p> </div> </div> </div> </li></ol> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Fang Tian. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z930877RWB"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-Z930877RWB");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>